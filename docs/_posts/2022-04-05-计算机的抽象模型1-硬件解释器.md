## 计算机的抽象模型 1
### 硬件解释器

现代计算机的实质是一套硬件解释器  

什么是解释器？  
解释器本身是一个程序，这个程序的输入是一串描述另一个程序的符号，输出是这串符号所描述的程序产生的结果。

为什么需要解释器？  
在现代计算机之前，编一个新程序需要一套重新设计的硬件结构，运行什么程序是由硬件结构决定的，想运行其他程序就需要改动硬件结构。  

硬件解释器不一样，硬件解释器的功能是读入一个程序，产生程序的结果。编程的复杂行为可以由硬件转变成软件，程序员不再需要关心线缆怎么连，只需要知道如何描述一个程序以及解释器如何解释程序。

冯诺依曼结构是一种可行的实现硬件解释器的方案。  

冯诺依曼结构把计算机分成运算器、控制器、存储器、输入输出。  
- 其中运算器和控制器功能由 CPU 实现  
- 存储器功能由 CPU 缓存和内存实现  

需要注意的是硬盘在冯诺依曼结构中属于由输入输出连接的外部设备，这个设备本身可以看作一个功能不完备的计算机。这台计算机只有存取数据的功能（这就是为什么内存又叫主存，而硬盘属于辅助存储器）。

GPU 同理可以看作只有特定计算功能的另一台计算机。

---

程序是可以被描述的  

如何描述一个程序？  
程序的描述方法有很多种，不同层级使用不同的描述。  

硬件解释器使用一种简单的线性结构，这种线性结构的每个元素被叫做一条指令。指令被编码成二进制串，不同编码的方法就是不同的指令集。 

这些指令大致有以下几种  

- 复制  
把一个位置的数据复制到另一个位置（从寄存器到内存、从内存到寄存器、从寄存器到寄存器等） 
 
- 计算  
对特定位置的数据进行运算、结果存储到特定位置  
运算可以是加减乘除、比较大小等

- 跳转  
解释器运行指令的时候默认顺序逐条执行，执行一条指令后默认执行下一条。跳转指令改变解释器下一条要执行的指令。
跳转的特殊之处是跳转可以有条件，条件符合则执行跳转，不符合则没有效果，继续执行下一跳指令。
条件的实现原理一般是检测某个特定位置的值。比如把比较大小的结果存入一个特定位置，然后检测这个结果，这就实现了根据两个数字的大小关系决定程序的执行流程的效果。

- 输入输出  
比如把特定位置的数值打印到屏幕上、把内存中的数据存到硬盘里，从硬盘读数据到内存里等。

---

在冯诺依曼结构中，控制器从存储器读入一条指令，将指令输入运算器，运算器执行指令的效果，然后决定下一个指令所在的地址，如果是跳转指令并且跳转的条件符合则将跳转的目标地址输出给控制器，否则直接输出顺序执行的下一个指令的地址，控制器拿到地址再用这个地址从存储器读入指令，以此完成整个循环。

细节可以参考  
- [Nandgame](https://nandgame.com/)  
与非门游戏，大约需要不超过10小时
该游戏从与非门搭建了一个功能大体上完整的计算机

- [From Nand to Tetris](https://www.nand2tetris.org/)  
从与非门到实现一个俄罗斯方块游戏
大约需要100小时

- [CSAPP](https://book.douban.com/subject/26344642/)  
Computer Systems: A Programmer's Perspective
仅前几章跟指令集有关的部分相关，只读前几章大约需要几十小时，粗略浏览可能需要几小时
